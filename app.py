import streamlit as st

# ============================
# 🛡️ 범죄 예방 안전 설문 프로그램 🛡️
# ============================

st.title("🛡️ 범죄 예방 안전 설문 프로그램")
st.write("당신의 생활 습관을 기반으로 범죄 노출 위험도를 평가합니다.")
st.write("설문 완료 후 안전 레벨과 예방 방법을 알려드립니다.\n")


# ============================
# 1. 범죄 유형 및 질문 정의
# ============================

crime_questions = {
    "성폭력": [
        "야간에 혼자 외출하는 경우가 자주 있다.",
        "주변 상황을 잘 살피지 않고 걷는 편이다.",
        "낯선 사람이 말을 걸어도 경계심이 낮은 편이다.",
        "귀가 시 동선이 일정해 누군가 예측하기 쉽다.",
        "위험 상황 대비 호루라기·안전 앱 등을 사용하지 않는다.",
        "술자리에서 음료를 방치하는 경우가 있다.",
        "귀가 시 골목이나 어두운 길을 이용할 때가 있다.",
        "택시나 대리 이용 시 차량 번호를 확인하지 않는다.",
        "위험 상황 시 도움 요청 방법을 잘 알지 못한다.",
        "돌발 상황에 대비한 대응법을 배우지 않았다."
    ],

    "학교폭력": [
        "불편하거나 괴롭힘을 당해도 주변에 알리지 않는 편이다.",
        "친구 관계에서 소외감을 느끼는 경우가 있다.",
        "또래의 부적절한 요구를 거절하기 어렵다.",
        "놀림을 받아도 적극적으로 대응하지 못한다.",
        "학교 내 CCTV가 닿지 않는 곳에 자주 머문다.",
        "문제가 생겨도 교사에게 상담하지 않는 편이다.",
        "위협 상황 시 피하거나 대응하는 법을 잘 모른다.",
        "괴롭힘 상황 목격 시 신고하지 못하는 편이다.",
        "SNS를 통한 욕설·따돌림을 경험한 적 있다.",
        "폭력 예방 교육에 참여한 경험이 부족하다."
    ],

    "사기": [
        "낯선 번호의 전화나 메시지에 응답하는 편이다.",
        "인터넷 중고 거래 시 판매자 정보 확인을 하지 않는다.",
        "문자 메시지 링크를 신뢰하고 클릭한 적 있다.",
        "개인 정보를 요구받으면 쉽게 알려주는 편이다.",
        "금융 관련 문자를 받으면 바로 확인하지 않는다.",
        "지나치게 싼 가격의 물건도 의심하지 않는 편이다.",
        "관공서 사칭 전화나 문자에 속은 적 있다.",
        "앱 설치를 요구하는 경우 경계하지 않는다.",
        "택배·배송 오류 관련 문자를 의심하지 않는다.",
        "온라인 결제 시 공식 서비스 여부를 잘 확인하지 않는다."
    ],

    "절도": [
        "가방이나 귀중품을 의자 또는 바닥에 두는 경우가 있다.",
        "집 문이나 차량 문을 잠그지 않는 경우가 있다.",
        "사물함이나 락커를 사용할 때 자물쇠를 사용하지 않는다.",
        "공공장소에서 소지품을 자주 확인하지 않는다.",
        "사람 많은 장소에서 경계심이 낮다.",
        "귀중품을 눈에 잘 띄는 곳에 두는 경우가 있다.",
        "출입문 비밀번호를 타인에게 노출한 적 있다.",
        "지갑이나 휴대폰을 뒷주머니에 두는 경우가 있다.",
        "현금이나 귀중품을 집에 아무 곳에나 보관한다.",
        "장시간 자리를 비울 때 소지품을 맡기지 않는다."
    ],

    "폭력": [
        "낯선 사람과 시비나 갈등에 자주 얽힌 편이다.",
        "격해진 상황에서 자주 감정을 조절하지 못한다.",
        "위험한 장소(심야, 술집 등)를 자주 방문한다.",
        "술자리에서 문제 상황을 겪은 적 있다.",
        "위협 상황에서 대처 방법을 잘 모른다.",
        "충돌 상황 시 즉시 거리를 두지 못한다.",
        "타인의 분노를 자극할 만한 행동을 할 때가 있다.",
        "주변에 도움 요청을 잘 하지 못한다.",
        "위험 상황을 직감해도 피하지 않는 편이다.",
        "폭력 위협 상황을 경험한 적 있다."
    ],

    "사이버 범죄": [
        "비밀번호를 여러 사이트에서 동일하게 사용한다.",
        "수상한 링크를 클릭한 적 있다.",
        "이중 인증(2FA)을 사용하지 않는다.",
        "SNS에 개인 정보를 많이 공개하는 편이다.",
        "알 수 없는 메일 첨부파일을 열어본 적 있다.",
        "공용 와이파이를 자주 사용한다.",
        "중요 계정 로그아웃을 하지 않는 경우가 있다.",
        "앱 설치 권한을 자세히 확인하지 않는다.",
        "SNS 메시지로 온 URL을 검증하지 않는다.",
        "보안 업데이트를 자주 하지 않는다."
    ],

    "스토킹": [
        "일정을 SNS에 공유하는 편이다.",
        "귀가 동선이 일정해 예측 가능하다.",
        "낯선 사람의 관심 표현을 경계하지 않는다.",
        "불쾌한 연락을 받아도 차단하지 않는 경우가 있다.",
        "사소한 의심을 무시하고 넘어가는 편이다.",
        "위협적인 인상을 받아도 신고하지 않는 편이다.",
        "지속 연락을 받아도 대응하지 않고 참고 넘긴다.",
        "위험 상황 시 주변에 알리지 않는 편이다.",
        "개인 정보가 쉽게 노출되는 SNS 사용을 한다.",
        "출근/퇴근 시간을 타인이 알기 쉽다."
    ],

    "음주운전": [
        "술 마신 후 운전한 경험이 있다.",
        "대리운전보다 운전을 직접 하려는 경향이 있다.",
        "음주 후 판단 능력이 저하되는 것을 인지하지 못한다.",
        "음주 후 이동 방안을 미리 계획하지 않는다.",
        "지인과의 음주 자리에서 차량을 가져가는 경우가 있다.",
        "음주 측정을 피하려 한 적 있다.",
        "술을 적게 마시면 운전해도 된다고 생각한다.",
        "음주 단속 정보를 찾아본 적 있다.",
        "피곤한 상태에서 운전하는 경우가 있다.",
        "음주운전의 위험성을 과소평가한다."
    ],

    "마약": [
        "낯선 사람이 건네는 음료나 약물을 경계하지 않는 편이다.",
        "유흥시설 방문 시 주변을 잘 살피지 않는다.",
        "의심스러운 약물을 봐도 신고하지 않는다.",
        "약물 관련 유혹을 단호하게 거절하지 못한다.",
        "주변에 마약 관련 정보를 가진 사람이 있다.",
        "약물 중독 위험성을 낮게 본다.",
        "마약류와 유사한 물질을 경험한 적 있다.",
        "온라인에서 의심스러운 약품을 본 적 있다.",
        "약물 사용 제안을 받아본 적 있다.",
        "위험 상황 발생 시 대응법을 잘 모른다."
    ],

    "교통사고": [
        "안전벨트를 착용하지 않는 경우가 있다.",
        "운전 중 휴대폰을 자주 본다.",
        "무리한 차선 변경을 할 때가 있다.",
        "신호가 바뀌기 전 급하게 통과하려 한다.",
        "졸음운전 경험이 있다.",
        "보행자 신호를 무시한 적 있다.",
        "야간 운전 시 경계심이 낮다.",
        "도로 위에서 속도를 자주 초과한다.",
        "보행 시 무단횡단을 한 적 있다.",
        "적정 거리 유지 운전을 잘 지키지 못한다."
    ]
}


# ============================
# 2. 예방 요약
# ============================

crime_prevention = {
    "성폭력": "🔹 주변을 항상 확인하고, 불안한 상황에서는 도움을 요청하세요.\n🔹 야간 귀가 시 밝은 길을 이용하세요.\n🔹 위치 공유 기능 및 안전 앱을 사용하세요.",
    "학교폭력": "🔹 혼자 해결하려 하지 말고 주변에 알리세요.\n🔹 위험 상황을 기록하고 선생님이나 보호자에게 상담하세요.",
    "사기": "🔹 링크 클릭은 절대 주의!\n🔹 개인정보·금융정보는 어떤 경우에도 공유하지 마세요.",
    "절도": "🔹 소지품은 몸 가까이에 두고 자주 확인하세요.\n🔹 잠금 장치를 생활화하세요.",
    "폭력": "🔹 위험 상황에서는 즉시 벗어나세요.\n🔹 대치보다 회피가 우선입니다.",
    "사이버 범죄": "🔹 강력한 비밀번호와 2단계 인증 사용!\n🔹 출처 불명 링크는 절대 클릭하지 마세요.",
    "스토킹": "🔹 일정·위치 정보 공유를 최소화하세요.\n🔹 지속적인 위협은 기록하고 즉시 신고하세요.",
    "음주운전": "🔹 술 마신 날은 반드시 대리·대중교통 이용.\n🔹 절대 예외는 없습니다.",
    "마약": "🔹 낯선 사람이 주는 물건이나 약물을 절대 받지 마세요.\n🔹 의심 상황 즉시 주변에 알리기.",
    "교통사고": "🔹 교통법규 준수!\n🔹 안전벨트 착용과 주의 집중 필수."
}


# ============================
# 3. 범죄 유형 선택
# ============================

selected_crime = st.selectbox("평가할 범죄 유형을 선택하세요:", list(crime_questions.keys()))

st.markdown(f"### ▶ 선택한 범죄 유형: **{selected_crime}**")
st.write("아래 질문에 0~5점으로 답해주세요. (0=전혀 아니다, 5=매우 그렇다)\n")


# ============================
# 4. 설문 진행
# ============================

total_score = 0
questions = crime_questions[selected_crime]

for q in questions:
    score = st.slider(q, 0, 5, 0, key=q)
    total_score += score


# ============================
# 5. 안전 레벨 계산
# ============================

max_score = len(questions) * 5
risk_ratio = total_score / max_score
safety_level = 10 - int(risk_ratio * 9)
safety_level = max(1, min(10, safety_level))

level_explain = {
    1:"🚨 매우 위험",
    2:"⚠️ 매우 낮은 안전 수준",
    3:"⚠️ 위험 요소 다수 존재",
    4:"⚠️ 주의 필요",
    5:"⚠️ 다소 위험",
    6:"⚠️ 보통 수준",
    7:"✅ 다소 안전",
    8:"✅ 안전함",
    9:"🌟 매우 안전",
    10:"🌟 최상 안전"
}


# ============================
# 6. 결과 출력
# ============================

st.markdown("## 📝 설문 결과")
st.write(f"**총점:** {total_score} / {max_score}")
st.write(f"**안전 레벨:** {safety_level} / 10")
st.write(f"**설명:** {level_explain[safety_level]}")
st.write("---")


# ============================
# 7. 예방 방법 안내 여부 선택
# ============================

choice = st.radio("예방 방법을 보고 싶으신가요?", ["네", "아니요"])

if choice == "네":
    st.markdown("## 🛡️ 예방 방법 안내")
    st.write(crime_prevention[selected_crime])

    st.markdown("### 📌 맞춤형 안전 조언")
    if safety_level >= 8:
        st.success("현재 매우 안전한 생활 습관을 가지고 있습니다. 유지하세요!")
    elif safety_level >= 5:
        st.warning("일부 위험 요소가 존재합니다. 조금 더 주의가 필요합니다.")
    else:
        st.error("위험도가 매우 높습니다. 지금 바로 안전 습관 개선이 필요합니다.")
else:
    st.info("설문이 종료되었습니다. 안전한 하루 보내세요! 😊")
